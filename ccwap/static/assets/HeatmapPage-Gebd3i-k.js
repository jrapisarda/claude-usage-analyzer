import{u as k,j as e}from"./query-vendor-DAETOSEH.js";import{r as n}from"./react-vendor-CGr-4ZyM.js";import{n as C,g as H,h as L,u as M,a as S,f as $,L as D}from"./index-DZMFuYgm.js";import{P as E}from"./PageLayout-DEtLmFLB.js";import{M as m}from"./MetricCard-BoawkqIY.js";import{C as T}from"./ChartCard-Cn7QorEQ.js";import{H as _}from"./HeatmapGrid-C-s6UJOE.js";import{E as A}from"./ErrorState-xqkb_4mP.js";import"./chart-vendor-Df4oWUqu.js";function N(s,t){return k({queryKey:C.data(s,t),queryFn:()=>H(`/heatmap${L({from:s.from,to:s.to,metric:t})}`)})}const P=["sessions","cost","loc","tool_calls"],p={sessions:"Sessions",cost:"Cost",loc:"Lines of Code",tool_calls:"Tool Calls"},y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],V=Array.from({length:24},(s,t)=>`${t}`);function O(){const{dateRange:s}=M(),[t,x]=n.useState("sessions"),{data:o,isLoading:g,error:d}=N(s,t),r=n.useMemo(()=>t==="cost"?a=>S(a):a=>$(a),[t]),h=n.useMemo(()=>o?o.cells.filter(a=>a.day>=0&&a.day<7&&a.hour>=0&&a.hour<24).map(a=>({row:a.day,col:a.hour,value:a.value})):[],[o]),{total:v,peakDay:j,peakHour:b,peakVal:f}=n.useMemo(()=>{if(!o||o.cells.length===0)return{total:0,peakDay:0,peakHour:0,peakVal:0};let a=0,u=0,i=0,c=0;for(const l of o.cells)a+=l.value,l.value>c&&(c=l.value,u=l.day,i=l.hour);return{total:a,peakDay:u,peakHour:i,peakVal:c}},[o]);return g?e.jsx(D,{message:"Loading heatmap..."}):d?e.jsx(A,{message:d.message}):o?e.jsxs(E,{title:"Activity Heatmap",subtitle:"Hourly activity patterns across days of the week",children:[e.jsx("div",{className:"flex gap-1 mb-6",children:P.map(a=>e.jsx("button",{onClick:()=>x(a),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${a===t?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-accent"}`,children:p[a]},a))}),e.jsx(T,{title:`${p[t]} by Day & Hour`,children:e.jsx(_,{data:h,rowLabels:y,colLabels:V,maxValue:o.max_value,formatValue:r,formatTooltip:(a,u,i)=>`${a} ${u}:00 - ${r(i)}`})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4",children:[e.jsx(m,{title:`Total ${p[t]}`,value:r(v)}),e.jsx(m,{title:"Peak Day",value:y[j]||"N/A",subtitle:r(f)}),e.jsx(m,{title:"Peak Hour",value:`${b}:00`,subtitle:r(f)}),e.jsx(m,{title:"Max Cell",value:r(o.max_value)})]})]}):null}export{O as default};
