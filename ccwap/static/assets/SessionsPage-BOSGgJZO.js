import{j as e}from"./query-vendor-DAETOSEH.js";import{u as g,r as a,L as l}from"./react-vendor-CGr-4ZyM.js";import{P as f}from"./PageLayout-DEtLmFLB.js";import{u as j,L as b,a as N,c as y,f as m}from"./index-DZMFuYgm.js";import{u as _}from"./sessions-_V8NQoi3.js";import{E as w}from"./ErrorState-xqkb_4mP.js";import{E as v}from"./EmptyState-D7Ng6sxx.js";import{E as C}from"./ExportDropdown-B2A0w648.js";import{A as L}from"./arrow-left-Az4NKZJP.js";import{C as S}from"./chevron-left-CNcf3mbC.js";import{C as E}from"./chevron-right-DICnz5OL.js";import"./chart-vendor-Df4oWUqu.js";import"./download-Bat12fqC.js";function H(){const[c]=g(),r=c.get("project")||void 0,{dateRange:x}=j(),[o,n]=a.useState(1),{data:s,isLoading:p,error:i}=_(x,r,o),u=a.useCallback(()=>n(t=>Math.max(1,t-1)),[]),h=a.useCallback(()=>n(t=>Math.min(s?.pagination.total_pages??t,t+1)),[s]),d=r?.replace(/^.*--/,"").replace(/-/g,"/")||null;return e.jsxs(f,{title:"Sessions",subtitle:d?`Filtered by ${d}`:"All sessions",actions:s?.sessions&&e.jsx(C,{page:"sessions",getData:()=>(s?.sessions||[]).map(t=>({session_id:t.session_id,project:t.project_display||t.project_path,timestamp:t.first_timestamp||"",duration:t.duration_seconds,cost:t.cost,turns:t.turns,tool_calls:t.tool_calls,errors:t.errors,model:t.model||"",branch:t.git_branch||""})),columns:["session_id","project","timestamp","duration","cost","turns","tool_calls","errors","model","branch"]}),children:[r&&e.jsxs(l,{to:"/projects",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(L,{className:"h-4 w-4"})," Back to projects"]}),p?e.jsx(b,{message:"Loading sessions..."}):i?e.jsx(w,{message:i.message}):!s||s.sessions.length===0?e.jsx(v,{message:"No sessions found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50 border-b border-border",children:[e.jsx("th",{className:"text-left px-4 py-3 font-medium text-muted-foreground",children:"Session"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-muted-foreground",children:"Project"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-muted-foreground",children:"Cost"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-muted-foreground",children:"Duration"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-muted-foreground",children:"Turns"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-muted-foreground",children:"Tools"}),e.jsx("th",{className:"text-right px-4 py-3 font-medium text-muted-foreground",children:"Errors"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-muted-foreground",children:"Model"}),e.jsx("th",{className:"text-left px-4 py-3 font-medium text-muted-foreground",children:"Branch"})]})}),e.jsx("tbody",{children:s.sessions.map(t=>e.jsxs("tr",{className:"border-b border-border hover:bg-accent/10 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs(l,{to:`/sessions/${t.session_id}`,className:"text-primary hover:underline font-mono text-xs",children:[t.session_id.slice(0,12),"..."]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:t.first_timestamp?new Date(t.first_timestamp).toLocaleString():"N/A"}),e.jsx("div",{className:"flex gap-1 mt-0.5",children:t.is_agent&&e.jsx("span",{className:"text-[10px] bg-purple-500/20 text-purple-400 px-1 py-0.5 rounded",children:"agent"})})]}),e.jsx("td",{className:"px-4 py-3 truncate max-w-[200px]",children:t.project_display||t.project_path}),e.jsx("td",{className:"px-4 py-3 font-mono text-right whitespace-nowrap",children:N(t.cost)}),e.jsx("td",{className:"px-4 py-3 font-mono text-right whitespace-nowrap",children:y(t.duration_seconds)}),e.jsxs("td",{className:"px-4 py-3 font-mono text-right",children:[m(t.turns),e.jsxs("span",{className:"text-muted-foreground text-xs ml-1",title:"user turns",children:["(",t.user_turns," user)"]})]}),e.jsx("td",{className:"px-4 py-3 font-mono text-right",children:m(t.tool_calls)}),e.jsx("td",{className:"px-4 py-3 font-mono text-right",children:e.jsx("span",{className:t.errors>0?"text-amber-400":"",children:t.errors})}),e.jsx("td",{className:"px-4 py-3 font-mono text-xs truncate max-w-[120px]",children:t.model||"N/A"}),e.jsx("td",{className:"px-4 py-3 font-mono text-xs truncate max-w-[120px]",children:t.git_branch||""})]},t.session_id))})]})})}),s.pagination.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s.pagination.page," of ",s.pagination.total_pages," (",s.pagination.total_count," sessions)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,disabled:o<=1,className:"p-2 rounded border border-border hover:bg-accent disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(S,{className:"h-4 w-4"})}),e.jsx("button",{onClick:h,disabled:o>=s.pagination.total_pages,className:"p-2 rounded border border-border hover:bg-accent disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(E,{className:"h-4 w-4"})})]})]})]})]})}export{H as default};
